<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% block content %}
    <title>MED360 | Register</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/normalize/5.0.0/normalize.min.css" rel="stylesheet">
    <link href='https://cdnjs.cloudflare.com/ajax/libs/bulma/0.6.2/css/bulma.min.css' rel='stylesheet'>
    <style>
		.column {
			padding-top: 0 !important;
			padding-bottom: 0 !important;
		}
		.row-one {
			padding-top: 13px;
		}
		form .field {
			margin: auto;
			max-width: 740px;
		}


    </style>
    <script>
	  window.console = window.console || function(t) {};


    </script>
    <script>
	  if (document.location.search.match(/type=embed/gi)) {
		window.parent.postMessage("resize", "*");
	  }


    </script>
</head>
<body translate="no">
<div id="app">
    <div class="section">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="container is-fluid">
            <br>
            <div class="notification is-danger is-pulled-right" style="width:25%;">
                <button class="delete"></button>
                {% for message in messages %}
                <strong>{{ message }}</strong>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% endwith %}
        <div class="container">
            <div class="title">Sign Up</div>
            <div class="subtitle">With Your Email</div>
            <form action="" id="register-form" method="POST">
                {{form.hidden_tag()}}
                <div class="field">
                    <label class="label" for="uname">Username</label>
                    <div class="control has-icons-left">
                        {{form.uname(class_='input')}}
                        <span class="icon is-left"><i class="fa">user</i></span>
                    </div>
                    <label class="label" for="mail">Email</label>
                    <div class="control has-icons-left">
                        {{form.mail(class_='input')}}
                        <span class="icon is-left"><i class="fa">envelope-square</i></span>
                    </div>
                    <label class="label" for="name">Name</label>
                    <div class="control has-icons-left">
                        <input class="input" name="firstName" placeholder="First Name" type="text"/>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label" for="password">Password</label>
                            <div class="control has-icons-left">
                                {{form.passw(class_='input')}}
                                <span class="icon is-left"><i class="fa">key</i></span>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label" for="conf_passw">Re-Type Password</label>
                            <div class="control has-icons-left">
                                {{form.conf_passw(class_='input')}}
                                <span class="icon is-left"><i class="fa">lock</i></span>
                            </div>
                        </div>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label" for="firstName">First Name</label>
                            <div class="control">
                                <input class="input" name="firstName" placeholder="First Name" type="text"/>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label" for="lastName">Last Name</label>
                            <div class="control">
                                <input class="input" name="lastName" placeholder="Last Name" type="text"/>
                            </div>
                        </div>
                    </div>
                    <div class="field is-grouped">
                        <div class="control">
                            <button class="button is-medium">Login</button>
                        </div>
                        <div class="control">
                            <button class="button is-primary is-medium" type="submit">Register</button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</div>
{% endblock %}
<script src='https://use.fontawesome.com/releases/v5.0.10/js/all.js'></script>
<script>
        let state_select = document.getElementById('state')
        let city_select = document.getElementById('city')
        state_select.onchange = function(){
            state = state_select.value;
            fetch('/city/'+state).then(function(response){
                response.json().then(function(data){
                    let optionHTML = '';
                    for (city of data.cities){
                        optionHTML += '<option value="'+city.id+'">'+city.name+'</option>';
                    }
                    city_select.innerHTML = optionHTML;
                });
            });
        }

       let input = document.querySelector('input[name=uname]');
       var message = document.getElementById('error-nwl-usr');
        var goodColor = "#66cc66";
        var badColor = "#ff6666";
       input.onkeyup = function() {
            $.get('/check/' + input.value, function(data) {
                if (data == false){
                    message.style.color = goodColor;
                    message.innerHTML = "Username is available!"
                }else{
                    message.style.color = badColor;
                    message.innerHTML = "Username is not available!"
                }
            });
        };

		$('#conf_passw').on('keyup', function ()
		{
			var pass1 = document.getElementById('passw');
			var pass2 = document.getElementById('conf_passw');
			var message = document.getElementById('error-nwl');
			var goodColor = "#66cc66";
			var badColor = "#ff6666";

			if(pass1.value.length > 5)
			{
				pass1.style.backgroundColor = goodColor;
				message.style.color = goodColor;
				message.innerHTML = "character number ok!"
			}
			else
			{
				pass1.style.backgroundColor = badColor;
				message.style.color = badColor;
				message.innerHTML = " you have to enter at least 6 digit!"
				return;
			}

			if(pass1.value == pass2.value)
			{
				pass2.style.backgroundColor = goodColor;
				message.style.color = goodColor;
				message.innerHTML = "ok!"
			}
			else
			{
				pass2.style.backgroundColor = badColor;
				message.style.color = badColor;
				message.innerHTML = " These passwords don't match"
			}
		});


</script>
</body>
</html>
