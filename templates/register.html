<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    {% block content %}
    <title>MED360 | Register</title>
    <meta content="width=device-width, initial-scale=1" name="viewport">
    <script src="{{ url_for('static',filename='js/fa.js') }}"></script>
    <link href="{{ url_for('static',filename='css/neumorphic_login.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ url_for('static',filename='css/bulma.min.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ url_for('static',filename='css/nunito-google.css') }}" rel="stylesheet" type="text/css">
    <link href="{{ url_for('static',filename='css/font-awesome.min.css') }}" rel="stylesheet" type="text/css">
    <style>
		.column {
			padding-top: 0 !important;
			padding-bottom: 0 !important;
		}
		.row-one {
			padding-top: 13px;
		}
        form .field {
			margin: auto;
			max-width: 740px;
		}
		.control.has-icons-left .icon.is-left, .control.has-icons-right .icon.is-right {
            color:#666666
		}
    </style>
    <script>
	  window.console = window.console || function(t) {};


    </script>
    <script>
	  if (document.location.search.match(/type=embed/gi)) {
		window.parent.postMessage("resize", "*");
	  }


    </script>
</head>
<body translate="no">
<section class="hero is-fullheight body" id="app">
    <div class="section">
        {% with messages = get_flashed_messages() %}
        {% if messages %}
        <div class="container is-fluid">
            <br>
            <div class="notification is-danger is-pulled-right" style="width:25%;">
                <button class="delete"></button>
                {% for message in messages %}
                <strong>{{ message }}</strong>
                {% endfor %}
            </div>
        </div>
        {% endif %}
        {% endwith %}
        <div class="container login is-9">
            <div class="columns is-mobile is-centered">
                <img alt="MED360" src="{{url_for('static', filename='med.png')}}" width="325px"/>
            </div>
            <form action="" id="register-form" method="POST">
                {{form.hidden_tag()}}
                <div class="field">
                    <label class="label">Name</label>
                    <div class="control has-icons-left">
                        {{form.name(class_='input is-rounded')}}
                        <span class="icon is-left"><em class="fa">user</em></span>
                    </div>
                    <label class="label">Username</label>
                    <div class="control has-icons-left">
                        {{form.uname(class_='input is-rounded')}}
                        <span class="icon is-left" id="username_tick"><em class="fa fa-user-circle"></em></span>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label">Email</label>
                            <div class="control has-icons-left">
                                {{form.mail(class_='input is-rounded')}}
                                <span class="icon is-left"><em class="fa">envelope-square</em></span>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label">Mobile</label>
                            <div class="control has-icons-left">
                                {{form.mobile(class_='input is-rounded')}}
                                <span class="icon is-left"><em class="fa fa-phone "></em></span>
                            </div>
                        </div>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label">Password</label>
                            <div class="control has-icons-left">
                                {{form.passw(class_='input is-rounded')}}
                                <span class="icon is-left"><em class="fa">key</em></span>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label">Confirm Passsword</label>
                            <div class="control has-icons-left">
                                {{form.conf_passw(class_='input is-rounded')}}
                                <span class="icon is-left"><em class="fa">lock</em></span>
                            </div>
                        </div>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label">Sex</label>
                            <div class="control has-icons-right">
                                {{form.sex(class_='input is-rounded', style='background:#D9DDE6')}}
                                <span class="icon is-right"><em class="fa">chevron-down</em></span>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label">Blood Group</label>
                            <div class="control has-icons-right">
                                {{form.bld_grp(class_='input is-rounded', style='background:#D9DDE6')}}
                                <span class="icon is-right"><em class="fa">chevron-down</em></span>
                            </div>
                        </div>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label">Date of Birth</label>
                            <div class="control">
                                {{form.dob(class_='input is-rounded', style='background:#D9DDE6')}}
                            </div>
                        </div>
                        <div class="column">
                            <label class="label">Donor</label>
                            <div class="control has-icons-right">
                                {{form.donor(class_='input is-rounded', style='background:#D9DDE6')}}
                                <span class="icon is-right"><em class="fa">chevron-down</em></span>
                            </div>
                        </div>
                    </div>
                    <label class="label">Address</label>
                    <div class="control has-icons-left">
                        {{form.addr(class_='input is-rounded')}}
                        <span class="icon is-left"><em class="fa fa-map-marker"></em></span>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label">State</label>
                            <div class="control has-icons-right">
                                {{form.state(class_='input is-rounded', style='background:#D9DDE6')}}
                                <span class="icon is-right"><em class="fa">chevron-down</em></span>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label">City</label>
                            <div class="control has-icons-right">
                                {{form.city(class_='input is-rounded', style='background:#D9DDE6')}}
                                <span class="icon is-right"><em class="fa">chevron-down</em></span>
                            </div>
                        </div>
                    </div>
                    <div class="columns row-one">
                        <div class="column">
                            <label class="label">Pincode</label>
                            <div class="control has-icons-left">
                                {{form.pincode(class_='input is-rounded')}}
                                <span class="icon is-left"><em class="fa">map-pin</em></span>
                            </div>
                        </div>
                        <div class="column">
                            <label class="label">Aadhaar</label>
                            <div class="control has-icons-left">
                                {{form.aadhar(class_='input is-rounded')}}
                                <span class="icon is-left"><em class="fa">id-card</em></span>
                            </div>
                        </div>
                    </div>
                    <div class="field is-grouped">
                        <div class="control">
                            <button class="button is-link is-medium is-block is-fullwidth is-rounded">Login</button>
                        </div>
                        <div class="control">
                            <button class="button is-primary is-medium is-block is-fullwidth is-rounded" type="submit">
                                Register
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</section>
{% endblock %}
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js"></script>
<script>
        let state_select = document.getElementById('state')
        let city_select = document.getElementById('city')
        state_select.onchange = function(){
            state = state_select.value;
            fetch('/city/'+state).then(function(response){
                response.json().then(function(data){
                    let optionHTML = '';
                    for (city of data.cities){
                        optionHTML += '<option value="'+city.id+'">'+city.name+'</option>';
                    }
                    city_select.innerHTML = optionHTML;
                });
            });
        }

       let input = document.getElementById('uname');
       let fa_icon = document.getElementById('username_tick');
        var goodColor = "#66cc66";
        var badColor = "#ff6666";
       input.onkeyup = function() {
            fetch('/check/'+input.value).then(function(response){
                response.json().then(function(data){
                    if (data == false){
                        fa_icon.style.color = goodColor;
                        fa_icon.innerHTML = "<i class='fa fa-user-circle'>"
                    }else{
                        fa_icon.style.color = badColor;
                        fa_icon.innerHTML = "<i class='fa fa-times-circle'>"
                    }
                });
            });
            $.get('/check/' + input.value, function(data) {

            });
        };

		$('#conf_passw').on('keyup', function ()
		{
			var pass1 = document.getElementById('passw');
			var pass2 = document.getElementById('conf_passw');
			var message = document.getElementById('error-nwl');
			var goodColor = "#66cc66";
			var badColor = "#ff6666";

			if(pass1.value.length > 5)
			{
				pass1.style.backgroundColor = goodColor;
				message.style.color = goodColor;
				message.innerHTML = "character number ok!"
			}
			else
			{
				pass1.style.backgroundColor = badColor;
				message.style.color = badColor;
				message.innerHTML = " you have to enter at least 6 digit!"
				return;
			}

			if(pass1.value == pass2.value)
			{
				pass2.style.backgroundColor = goodColor;
				message.style.color = goodColor;
				message.innerHTML = "ok!"
			}
			else
			{
				pass2.style.backgroundColor = badColor;
				message.style.color = badColor;
				message.innerHTML = " These passwords don't match"
			}
		});


</script>
</body>
</html>
